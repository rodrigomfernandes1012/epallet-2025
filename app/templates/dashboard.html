{% extends "layouts/base.html" %}

{% block title %}Dashboard{% endblock %}
{% block breadcrumb %}Dashboard{% endblock %}
{% block page_title %}Dashboard{% endblock %}

{% block content %}
<!-- Cards de Estat√≠sticas Existentes -->
<div class="row">
    <div class="col-xl-3 col-sm-6 mb-xl-0 mb-4">
        <div class="card">
            <div class="card-body p-3">
                <div class="row">
                    <div class="col-8">
                        <div class="numbers">
                            <p class="text-sm mb-0 text-capitalize font-weight-bold">Total de Empresas</p>
                            <h5 class="font-weight-bolder mb-0">
                                {{ stats.total_empresas }}
                                <span class="text-success text-sm font-weight-bolder">+{{ stats.empresas_mes }}</span>
                            </h5>
                        </div>
                    </div>
                    <div class="col-4 text-end">
                        <div class="icon icon-shape bg-gradient-primary shadow text-center border-radius-md">
                            <i class="ni ni-building text-lg opacity-10" aria-hidden="true"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-sm-6 mb-xl-0 mb-4">
        <div class="card">
            <div class="card-body p-3">
                <div class="row">
                    <div class="col-8">
                        <div class="numbers">
                            <p class="text-sm mb-0 text-capitalize font-weight-bold">Vales Pendentes</p>
                            <h5 class="font-weight-bolder mb-0">
                                {{ stats.vales_pendentes }}
                                <span class="text-warning text-sm font-weight-bolder">pendentes</span>
                            </h5>
                        </div>
                    </div>
                    <div class="col-4 text-end">
                        <div class="icon icon-shape bg-gradient-warning shadow text-center border-radius-md">
                            <i class="ni ni-time-alarm text-lg opacity-10" aria-hidden="true"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-sm-6 mb-xl-0 mb-4">
        <div class="card">
            <div class="card-body p-3">
                <div class="row">
                    <div class="col-8">
                        <div class="numbers">
                            <p class="text-sm mb-0 text-capitalize font-weight-bold">Entregas Realizadas</p>
                            <h5 class="font-weight-bolder mb-0">
                                {{ stats.vales_realizados }}
                                <span class="text-success text-sm font-weight-bolder">completos</span>
                            </h5>
                        </div>
                    </div>
                    <div class="col-4 text-end">
                        <div class="icon icon-shape bg-gradient-success shadow text-center border-radius-md">
                            <i class="ni ni-check-bold text-lg opacity-10" aria-hidden="true"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-sm-6">
        <div class="card">
            <div class="card-body p-3">
                <div class="row">
                    <div class="col-8">
                        <div class="numbers">
                            <p class="text-sm mb-0 text-capitalize font-weight-bold">Total de Pallets</p>
                            <h5 class="font-weight-bolder mb-0">
                                {{ stats.total_pallets }}
                                <span class="text-info text-sm font-weight-bolder">unidades</span>
                            </h5>
                        </div>
                    </div>
                    <div class="col-4 text-end">
                        <div class="icon icon-shape bg-gradient-info shadow text-center border-radius-md">
                            <i class="fas fa-pallet text-lg opacity-10" aria-hidden="true"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- CARDS DE VENCIMENTO (INCLUINDO NOVO CARD DE VENCIDOS) -->
<div class="row mt-5 mb-4">
    <div class="col-xl-2 col-sm-6 mb-xl-0 mb-4">
        <div class="card">
            <div class="card-body p-3">
                <div class="row">
                    <div class="col-12">
                        <div class="numbers text-center">
                            <p class="text-xs mb-0 text-capitalize font-weight-bold">Vencidos</p>
                            <h4 class="font-weight-bolder mb-0" style="color: #8B0000;">
                                {{ stats.pallets_vencidos }}
                            </h4>
                            <p class="text-xs text-secondary mb-0">pallets</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-xl-2 col-sm-6 mb-xl-0 mb-4">
        <div class="card">
            <div class="card-body p-3">
                <div class="row">
                    <div class="col-12">
                        <div class="numbers text-center">
                            <p class="text-xs mb-0 text-capitalize font-weight-bold">Vencendo Hoje</p>
                            <h4 class="font-weight-bolder mb-0 text-danger">
                                {{ stats.pallets_vencendo_hoje }}
                            </h4>
                            <p class="text-xs text-secondary mb-0">pallets</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-xl-2 col-sm-6 mb-xl-0 mb-4">
        <div class="card">
            <div class="card-body p-3">
                <div class="row">
                    <div class="col-12">
                        <div class="numbers text-center">
                            <p class="text-xs mb-0 text-capitalize font-weight-bold">Em 3 Dias</p>
                            <h4 class="font-weight-bolder mb-0 text-warning">
                                {{ stats.pallets_vencendo_3_dias }}
                            </h4>
                            <p class="text-xs text-secondary mb-0">pallets</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-xl-2 col-sm-6 mb-xl-0 mb-4">
        <div class="card">
            <div class="card-body p-3">
                <div class="row">
                    <div class="col-12">
                        <div class="numbers text-center">
                            <p class="text-xs mb-0 text-capitalize font-weight-bold">Em 7 Dias</p>
                            <h4 class="font-weight-bolder mb-0 text-info">
                                {{ stats.pallets_vencendo_7_dias }}
                            </h4>
                            <p class="text-xs text-secondary mb-0">pallets</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-xl-2 col-sm-6 mb-xl-0 mb-4">
        <div class="card">
            <div class="card-body p-3">
                <div class="row">
                    <div class="col-12">
                        <div class="numbers text-center">
                            <p class="text-xs mb-0 text-capitalize font-weight-bold">At√© 30 Dias</p>
                            <h4 class="font-weight-bolder mb-0 text-primary">
                                {{ stats.pallets_vencendo_30_dias }}
                            </h4>
                            <p class="text-xs text-secondary mb-0">pallets</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-xl-2 col-sm-6 mb-xl-0 mb-4">
        <div class="card">
            <div class="card-body p-3">
                <div class="row">
                    <div class="col-12">
                        <div class="numbers text-center">
                            <p class="text-xs mb-0 text-capitalize font-weight-bold">Acima 30 Dias</p>
                            <h4 class="font-weight-bolder mb-0 text-secondary">
                                {{ stats.pallets_vencendo_acima_30_dias }}
                            </h4>
                            <p class="text-xs text-secondary mb-0">pallets</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-xl-2 col-sm-6">
        <div class="card">
            <div class="card-body p-3">
                <div class="row">
                    <div class="col-12">
                        <div class="numbers text-center">
                            <p class="text-xs mb-0 text-capitalize font-weight-bold">Total a Devolver</p>
                            <h4 class="font-weight-bolder mb-0 text-success">
                                {{ stats.total_pallets_devolver }}
                            </h4>
                            <p class="text-xs text-secondary mb-0">pallets</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- GR√ÅFICO: Top 10 Destinat√°rios -->
<div class="row mt-5 mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header pb-0">
                <h6>Top 10 Destinat√°rios com Mais Pallets para Devolu√ß√£o</h6>
                <p class="text-sm mb-0">
                    <i class="fas fa-chart-bar text-info"></i>
                    <span class="font-weight-bold">{{ top_destinatarios|length }}</span> destinat√°rios com pallets pendentes
                </p>
            </div>
            <div class="card-body">
                <div class="chart">
                    <canvas id="chartTopDestinatarios" class="chart-canvas" height="300"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- NOVO: CALEND√ÅRIO ESTILO GOOGLE AGENDA -->
<div class="row mt-5 mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header pb-0">
                <div class="row">
                    <div class="col-lg-6">
                        <h6>Calend√°rio de Devolu√ß√µes</h6>
                        <p class="text-sm mb-0">
                            <i class="fas fa-calendar text-info"></i>
                            Agendamentos e vencimentos
                        </p>
                    </div>
                    <div class="col-lg-6 text-end">
                        <!-- Controles de visualiza√ß√£o -->
                        <div class="btn-group" role="group">
                            <button type="button" class="btn btn-sm btn-outline-primary" id="btnView7Days">7 Dias</button>
                            <button type="button" class="btn btn-sm btn-outline-primary active" id="btnView30Days">30 Dias</button>
                        </div>
                        <div class="btn-group ms-2" role="group">
                            <button type="button" class="btn btn-sm btn-outline-secondary" id="btnPrevMonth">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <button type="button" class="btn btn-sm btn-outline-secondary" id="btnToday">Hoje</button>
                            <button type="button" class="btn btn-sm btn-outline-secondary" id="btnNextMonth">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card-body">
                <div id="calendario" class="calendario-container"></div>
                
                <!-- Legenda -->
                <div class="row mt-3">
                    <div class="col-12">
                        <div class="d-flex justify-content-center">
                            <div class="me-4">
                                <span class="badge bg-success me-1">‚óè</span>
                                <span class="text-xs">Agendamento de Devolu√ß√£o</span>
                            </div>
                            <div>
                                <span class="badge bg-danger me-1">‚óè</span>
                                <span class="text-xs">Vencimento sem Agendamento</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Gr√°ficos e Informa√ß√µes -->
<div class="row mt-4">
    <div class="col-lg-7 mb-lg-0 mb-4">
        <div class="card">
            <div class="card-header pb-0">
                <h6>Vales Pallet Recentes</h6>
                <p class="text-sm">
                    <i class="fa fa-arrow-up text-success"></i>
                    <span class="font-weight-bold">{{ stats.vales_mes_atual }}</span> vales este m√™s
                </p>
            </div>
            <div class="card-body px-0 pt-0 pb-2">
                <div class="table-responsive p-0">
                    <table class="table align-items-center mb-0">
                        <thead>
                            <tr>
                                <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Documento</th>
                                <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Cliente</th>
                                <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Pallets</th>
                                <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Status</th>
                                <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Data</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for vale in vales_recentes %}
                            <tr>
                                <td>
                                    <div class="d-flex px-2 py-1">
                                        <div class="d-flex flex-column justify-content-center">
                                            <h6 class="mb-0 text-sm">{{ vale.numero_documento }}</h6>
                                            <p class="text-xs text-secondary mb-0">PIN: {{ vale.pin }}</p>
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <p class="text-xs font-weight-bold mb-0">{{ vale.cliente_nome }}</p>
                                    <p class="text-xs text-secondary mb-0">{{ vale.transportadora_nome }}</p>
                                </td>
                                <td class="align-middle text-center text-sm">
                                    <span class="text-xs font-weight-bold">{{ vale.quantidade_pallets }}</span>
                                </td>
                                <td class="align-middle text-center text-sm">
                                    <span class="text-secondary text-sm font-weight-bold">{{ vale.get_status_display() }}</span>
                                </td>
                                <td class="align-middle text-center">
                                    <span class="text-secondary text-xs font-weight-bold">{{ vale.data_criacao.strftime('%d/%m/%Y') }}</span>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-5">
        <div class="card h-100">
            <div class="card-header pb-0">
                <h6>Estat√≠sticas por Tipo de Empresa</h6>
            </div>
            <div class="card-body p-3">
                <div class="timeline timeline-one-side">
                    <div class="timeline-block mb-3">
                        <span class="timeline-step bg-gradient-success">
                            <i class="ni ni-badge text-white"></i>
                        </span>
                        <div class="timeline-content">
                            <h6 class="text-dark text-sm font-weight-bold mb-0">Clientes</h6>
                            <p class="text-secondary font-weight-normal text-xs mt-1 mb-0">{{ stats.empresas_por_tipo.get('Cliente', 0) }} empresas cadastradas</p>
                        </div>
                    </div>
                    <div class="timeline-block mb-3">
                        <span class="timeline-step bg-gradient-info">
                            <i class="ni ni-delivery-fast text-white"></i>
                        </span>
                        <div class="timeline-content">
                            <h6 class="text-dark text-sm font-weight-bold mb-0">Transportadoras</h6>
                            <p class="text-secondary font-weight-normal text-xs mt-1 mb-0">{{ stats.empresas_por_tipo.get('Transportadora', 0) }} empresas cadastradas</p>
                        </div>
                    </div>
                    <div class="timeline-block mb-3">
                        <span class="timeline-step bg-gradient-warning">
                            <i class="ni ni-pin-3 text-white"></i>
                        </span>
                        <div class="timeline-content">
                            <h6 class="text-dark text-sm font-weight-bold mb-0">Destinat√°rios</h6>
                            <p class="text-secondary font-weight-normal text-xs mt-1 mb-0">{{ stats.empresas_por_tipo.get('Destinat√°rio', 0) }} empresas cadastradas</p>
                        </div>
                    </div>
                    <div class="timeline-block">
                        <span class="timeline-step bg-gradient-primary">
                            <i class="ni ni-single-02 text-white"></i>
                        </span>
                        <div class="timeline-content">
                            <h6 class="text-dark text-sm font-weight-bold mb-0">Motoristas</h6>
                            <p class="text-secondary font-weight-normal text-xs mt-1 mb-0">{{ stats.total_motoristas }} motoristas cadastrados</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Atividades Recentes -->
<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header pb-0">
                <div class="row">
                    <div class="col-lg-6 col-7">
                        <h6>Atividades Recentes do Sistema</h6>
                        <p class="text-sm mb-0">
                            <i class="fa fa-check text-info" aria-hidden="true"></i>
                            <span class="font-weight-bold ms-1">{{ stats.logs_hoje }}</span> a√ß√µes registradas hoje
                        </p>
                    </div>
                </div>
            </div>
            <div class="card-body px-0 pb-2">
                <div class="table-responsive">
                    <table class="table align-items-center mb-0">
                        <thead>
                            <tr>
                                <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">M√≥dulo</th>
                                <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">A√ß√£o</th>
                                <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Usu√°rio</th>
                                <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Data/Hora</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for log in logs_recentes %}
                            <tr>
                                <td>
                                    <div class="d-flex px-2 py-1">
                                        <div class="d-flex flex-column justify-content-center">
                                            <h6 class="mb-0 text-sm">{{ log.modulo }}</h6>
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <p class="text-xs font-weight-bold mb-0">{{ log.acao }}</p>
                                    <p class="text-xs text-secondary mb-0">{{ log.descricao[:50] }}...</p>
                                </td>
                                <td class="align-middle text-center">
                                    <span class="text-xs font-weight-bold">{{ log.usuario_nome }}</span>
                                </td>
                                <td class="align-middle text-center">
                                    <span class="text-secondary text-xs font-weight-bold">{{ log.data_hora.strftime('%d/%m/%Y %H:%M') }}</span>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- CSS do Calend√°rio -->
<style>
.calendario-container {
    min-height: 400px;
}

.calendario-dia {
    border: 1px solid #e9ecef;
    padding: 10px;
    min-height: 100px;
    background: #fff;
    border-radius: 8px;
    margin-bottom: 10px;
}

.calendario-dia-header {
    font-weight: bold;
    font-size: 14px;
    margin-bottom: 8px;
    color: #344767;
}

.calendario-evento {
    padding: 6px 10px;
    border-radius: 6px;
    margin-bottom: 6px;
    font-size: 12px;
    cursor: pointer;
    transition: all 0.2s;
}

.calendario-evento:hover {
    transform: translateX(3px);
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.evento-agendamento {
    background: #d4edda;
    border-left: 4px solid #28a745;
    color: #155724;
}

.evento-vencimento {
    background: #f8d7da;
    border-left: 4px solid #dc3545;
    color: #721c24;
}

.evento-titulo {
    font-weight: 600;
    margin-bottom: 2px;
}

.evento-detalhes {
    font-size: 11px;
    opacity: 0.8;
}
</style>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
<script>
// Dados do backend
var agendamentos = {{ agendamentos|tojson }};
var vencimentos = {{ vencimentos_sem_agendamento|tojson }};

// Vari√°veis globais do calend√°rio
var currentView = 30; // 7 ou 30 dias
var currentDate = new Date();

document.addEventListener('DOMContentLoaded', function() {
    // Gr√°fico Top Destinat√°rios
    var ctx = document.getElementById('chartTopDestinatarios').getContext('2d');
    
    var labels = [
        {% for dest in top_destinatarios %}
        '{{ dest.razao_social }}'{% if not loop.last %},{% endif %}
        {% endfor %}
    ];
    
    var data = [
        {% for dest in top_destinatarios %}
        {{ dest.saldo }}{% if not loop.last %},{% endif %}
        {% endfor %}
    ];
    
    var colors = [
        'rgba(255, 99, 132, 0.8)',
        'rgba(54, 162, 235, 0.8)',
        'rgba(255, 206, 86, 0.8)',
        'rgba(75, 192, 192, 0.8)',
        'rgba(153, 102, 255, 0.8)',
        'rgba(255, 159, 64, 0.8)',
        'rgba(199, 199, 199, 0.8)',
        'rgba(83, 102, 255, 0.8)',
        'rgba(255, 99, 255, 0.8)',
        'rgba(99, 255, 132, 0.8)'
    ];
    
    var chart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [{
                label: 'Pallets a Devolver',
                data: data,
                backgroundColor: colors,
                borderColor: colors.map(c => c.replace('0.8', '1')),
                borderWidth: 2
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        stepSize: 10
                    }
                },
                x: {
                    ticks: {
                        maxRotation: 45,
                        minRotation: 45
                    }
                }
            }
        }
    });
    
    // Calend√°rio
    renderCalendario();
    
    // Eventos dos bot√µes
    document.getElementById('btnView7Days').addEventListener('click', function() {
        currentView = 7;
        document.getElementById('btnView7Days').classList.add('active');
        document.getElementById('btnView30Days').classList.remove('active');
        renderCalendario();
    });
    
    document.getElementById('btnView30Days').addEventListener('click', function() {
        currentView = 30;
        document.getElementById('btnView30Days').classList.add('active');
        document.getElementById('btnView7Days').classList.remove('active');
        renderCalendario();
    });
    
    document.getElementById('btnPrevMonth').addEventListener('click', function() {
        currentDate.setMonth(currentDate.getMonth() - 1);
        renderCalendario();
    });
    
    document.getElementById('btnToday').addEventListener('click', function() {
        currentDate = new Date();
        renderCalendario();
    });
    
    document.getElementById('btnNextMonth').addEventListener('click', function() {
        currentDate.setMonth(currentDate.getMonth() + 1);
        renderCalendario();
    });
});

function renderCalendario() {
    var container = document.getElementById('calendario');
    container.innerHTML = '';
    
    var hoje = new Date();
    hoje.setHours(0, 0, 0, 0);
    
    var dataInicio = new Date(currentDate);
    dataInicio.setHours(0, 0, 0, 0);
    
    // Criar grid de dias
    for (var i = 0; i < currentView; i++) {
        var data = new Date(dataInicio);
        data.setDate(data.getDate() + i);
        
        var diaDiv = document.createElement('div');
        diaDiv.className = 'calendario-dia';
        
        // Header do dia
        var header = document.createElement('div');
        header.className = 'calendario-dia-header';
        var diaSemana = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'S√°b'][data.getDay()];
        var dataStr = data.getDate() + '/' + (data.getMonth() + 1);
        header.textContent = diaSemana + ' ' + dataStr;
        diaDiv.appendChild(header);
        
        // Buscar eventos deste dia
        var dataKey = formatDate(data);
        
        // Agendamentos
        agendamentos.forEach(function(ag) {
            if (ag.data_agendamento === dataKey) {
                var evento = criarEventoAgendamento(ag);
                diaDiv.appendChild(evento);
            }
        });
        
        // Vencimentos
        vencimentos.forEach(function(venc) {
            if (venc.data_vencimento === dataKey) {
                var evento = criarEventoVencimento(venc);
                diaDiv.appendChild(evento);
            }
        });
        
        container.appendChild(diaDiv);
    }
}

function criarEventoAgendamento(ag) {
    var div = document.createElement('div');
    div.className = 'calendario-evento evento-agendamento';
    
    var titulo = document.createElement('div');
    titulo.className = 'evento-titulo';
    titulo.textContent = 'üì¶ ' + ag.destinatario_nome;
    div.appendChild(titulo);
    
    var detalhes = document.createElement('div');
    detalhes.className = 'evento-detalhes';
    detalhes.textContent = ag.quantidade_pallets + ' pallets agendados';
    div.appendChild(detalhes);
    
    div.addEventListener('click', function() {
        alert('Agendamento #' + ag.id + '\\n' +
              'Destinat√°rio: ' + ag.destinatario_nome + '\\n' +
              'Quantidade: ' + ag.quantidade_pallets + ' pallets\\n' +
              'Status: ' + ag.status);
    });
    
    return div;
}

function criarEventoVencimento(venc) {
    var div = document.createElement('div');
    div.className = 'calendario-evento evento-vencimento';
    
    var titulo = document.createElement('div');
    titulo.className = 'evento-titulo';
    titulo.textContent = '‚ö†Ô∏è ' + venc.destinatario_nome;
    div.appendChild(titulo);
    
    var saldo = venc.quantidade_pallets - venc.quantidade_devolvida;
    var detalhes = document.createElement('div');
    detalhes.className = 'evento-detalhes';
    detalhes.textContent = saldo + ' pallets vencendo';
    div.appendChild(detalhes);
    
    div.addEventListener('click', function() {
        alert('Vencimento sem Agendamento\\n' +
              'Destinat√°rio: ' + venc.destinatario_nome + '\\n' +
              'Pallets a devolver: ' + saldo + '\\n' +
              'Total no destinat√°rio: ' + venc.quantidade_pallets);
    });
    
    return div;
}

function formatDate(date) {
    var year = date.getFullYear();
    var month = String(date.getMonth() + 1).padStart(2, '0');
    var day = String(date.getDate()).padStart(2, '0');
    return year + '-' + month + '-' + day;
}
</script>
{% endblock %}
